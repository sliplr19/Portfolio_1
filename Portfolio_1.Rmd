---
title: "Portfolio_1"
author: "Lindley Slipetz"
date: "2/12/2021"
output: html_document
---

In this portfolio piece, we will look at how people's relationship to cooking and baking has changed pre- and during Covid. There are four spreadsheets in this file. I'm leaving off the first sheet because it uses a different scale than the other sheets. Also, there is no documentation for this data, and it's not exactly clear how the first sheet is measuring google trends. The final three are number of mentions of the activities on Twitter, Forums, and Blogs. Let's load some data! 

```{r setup, warning = FALSE}
library(readxl)
Cooking_Twitter_raw <- read_excel("G:/My Drive/DataScience/Covid/Cooking.xlsx", sheet = 2)
Cooking_Forums_raw <- read_excel("G:/My Drive/DataScience/Covid/Cooking.xlsx", sheet = 3)
Cooking_Blogs_raw <- read_excel("G:/My Drive/DataScience/Covid/Cooking.xlsx", sheet = 4)
library(tidyverse)
library(data.table)
```

This data is messy. Let's make it tidy! I'm not going to even try to work within these dataframes because they're just that messy. Let's start by making a new dataframe! We'll just get the columns together first and then we'll add the data.

```{r columns}
cooking_columns <- c("Venue", "Timepoint", "Recipes", "Baking_Bread", "Sourdough", "Cooking_directions", "Cook")
cooking_data <- as.data.frame(matrix(ncol = length(cooking_columns), nrow=0, dimnames = list(NULL,cooking_columns)) )
```

Okay, time to add the data to the new dataframe. 
df$major[df$degree1 == "BA"]
```{r add_data}
##Blog time 1
cooking_data <-rbind(cooking_data, data.frame(
   Venue = "Blog",
   Timepoint = 1,
   Recipes = Cooking_Blogs_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Blogs_raw$...7 == "Recipes" & is.na(Cooking_Blogs_raw$...7) == FALSE],
   Baking_Bread = Cooking_Blogs_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Blogs_raw$...7 == "Baking bread" & is.na(Cooking_Blogs_raw$...7) == FALSE], 
   Sourdough = Cooking_Blogs_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Blogs_raw$...7 == "Sourdough" & is.na(Cooking_Blogs_raw$...7) == FALSE],
   Cooking_directions = Cooking_Blogs_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Blogs_raw$...7 == "Cooking Directions" & is.na(Cooking_Blogs_raw$...7) == FALSE],
   Cook = Cooking_Blogs_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Blogs_raw$...7 == "Cook" & is.na(Cooking_Blogs_raw$...7) == FALSE]))
##Blog time 2  
cooking_data <-rbind(cooking_data, data.frame(
   Venue = "Blog",
   Timepoint = 2,
   Recipes = Cooking_Blogs_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Blogs_raw$...7 == "Recipes" & is.na(Cooking_Blogs_raw$...7) == FALSE],
   Baking_Bread = Cooking_Blogs_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Blogs_raw$...7 == "Baking bread" & is.na(Cooking_Blogs_raw$...7) == FALSE], 
   Sourdough = Cooking_Blogs_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Blogs_raw$...7 == "Sourdough" & is.na(Cooking_Blogs_raw$...7) == FALSE],
   Cooking_directions = Cooking_Blogs_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Blogs_raw$...7 == "Cooking Directions" & is.na(Cooking_Blogs_raw$...7) == FALSE],
   Cook = Cooking_Blogs_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Blogs_raw$...7 == "Cook" & is.na(Cooking_Blogs_raw$...7) == FALSE]))
##Twitter time 1  
cooking_data <-rbind(cooking_data, data.frame(
   Venue = "Twitter",
   Timepoint = 1,
 Recipes = Cooking_Twitter_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Twitter_raw$...7 == "Recipes" & is.na(Cooking_Twitter_raw$...7) == FALSE],
   Baking_Bread = Cooking_Twitter_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Twitter_raw$...7 == "Baking bread" & is.na(Cooking_Twitter_raw$...7) == FALSE], 
   Sourdough = Cooking_Twitter_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Twitter_raw$...7 == "Sourdough" & is.na(Cooking_Twitter_raw$...7) == FALSE],
   Cooking_directions = Cooking_Twitter_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Twitter_raw$...7 == "Cooking Directions" & is.na(Cooking_Twitter_raw$...7) == FALSE],
   Cook = Cooking_Twitter_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Twitter_raw$...7 == "Cook" & is.na(Cooking_Twitter_raw$...7) == FALSE]))
##Twitter time 2  
cooking_data <-rbind(cooking_data, data.frame(
   Venue = "Twitter",
   Timepoint = 2,
   Recipes = Cooking_Twitter_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Twitter_raw$...7 == "Recipes" & is.na(Cooking_Twitter_raw$...7) == FALSE],
   Baking_Bread = Cooking_Twitter_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Twitter_raw$...7 == "Baking bread" & is.na(Cooking_Twitter_raw$...7) == FALSE], 
   Sourdough = Cooking_Twitter_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Twitter_raw$...7 == "Sourdough" & is.na(Cooking_Twitter_raw$...7) == FALSE],
   Cooking_directions = Cooking_Twitter_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Twitter_raw$...7 == "Cooking Directions" & is.na(Cooking_Twitter_raw$...7) == FALSE],
   Cook = Cooking_Twitter_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Twitter_raw$...7 == "Cook" & is.na(Cooking_Twitter_raw$...7) == FALSE]))
##Forums time 1  
cooking_data <-rbind(cooking_data, data.frame(
   Venue = "Forums",
   Timepoint = 1,
 Recipes = Cooking_Forums_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Forums_raw$...7 == "Recipes" & is.na(Cooking_Forums_raw$...7) == FALSE],
   Baking_Bread = Cooking_Forums_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Forums_raw$...7 == "Baking bread" & is.na(Cooking_Forums_raw$...7) == FALSE], 
   Sourdough = Cooking_Forums_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Forums_raw$...7 == "Sourdough" & is.na(Cooking_Forums_raw$...7) == FALSE],
   Cooking_directions = Cooking_Forums_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Forums_raw$...7 == "Cooking Directions" & is.na(Cooking_Forums_raw$...7) == FALSE],
   Cook = Cooking_Forums_raw$`Mentions before March 13 (January 3, 2020-March 12, 2020)...8`[Cooking_Forums_raw$...7 == "Cook" & is.na(Cooking_Forums_raw$...7) == FALSE]))
##Forums time 2  
cooking_data <-rbind(cooking_data, data.frame(
   Venue = "Forums",
   Timepoint = 2,
   Recipes = Cooking_Forums_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Forums_raw$...7 == "Recipes" & is.na(Cooking_Forums_raw$...7) == FALSE],
   Baking_Bread = Cooking_Forums_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Forums_raw$...7 == "Baking bread" & is.na(Cooking_Forums_raw$...7) == FALSE], 
   Sourdough = Cooking_Forums_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Forums_raw$...7 == "Sourdough" & is.na(Cooking_Forums_raw$...7) == FALSE],
   Cooking_directions = Cooking_Forums_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Forums_raw$...7 == "Cooking Directions" & is.na(Cooking_Forums_raw$...7) == FALSE],
   Cook = Cooking_Forums_raw$`Mentions after March 13 (March 14, 2020-May 22, 2020)...10`[Cooking_Forums_raw$...7 == "Cook" & is.na(Cooking_Forums_raw$...7) == FALSE]))
```

Phew, now we have a tidy dataframe. Let's take a look at it.

```{r inspect_df}
glimpse(cooking_data)
```

Well, that didn't really tell us much. Let's look at the descriptives grouped by time point. First, our observations are factors at the moment, so let's fix that.

```{r not_factors}
cooking_data$Recipes <- as.numeric(as.character(cooking_data$Recipes))
cooking_data$Baking_Bread <- as.numeric(as.character(cooking_data$Baking_Bread))
cooking_data$Sourdough <- as.numeric(as.character(cooking_data$Sourdough))
cooking_data$Cooking_directions <- as.numeric(as.character(cooking_data$Cooking_directions))
cooking_data$Cook <- as.numeric(as.character(cooking_data$Cook))
```

Okay, now we can look at the means.

```{r descriptives}
cooking_mean <- setDT(cooking_data) 
cooking_mean[, .(Recipes = mean(Recipes), Baking_Bread = mean(Baking_Bread), Sourdough = mean(Sourdough), Cooking_directions = mean(Cooking_directions), Cook = mean(Cook)), by = .(Timepoint)]
```
Notice that the means across venues increase across time, but we don't know if that change is statistically significant. Let's do some paired sample t-tests. We're testing the hypothesis that time 1 mentions (pre-Covid) are significantly less than time 2 mentions (during-Covid).

```{r ttest}
t_Recipe <- t.test(Recipes ~ Timepoint, data = cooking_data, paired = TRUE, alternative = "less")
t_Recipe
t_Bread <- t.test(Baking_Bread ~ Timepoint, data = cooking_data, paired = TRUE, alternative = "less")
t_Bread
t_Sourdough <- t.test(Sourdough ~ Timepoint, data = cooking_data, paired = TRUE, alternative = "less")
t_Sourdough
t_Directions <- t.test(Cooking_directions ~ Timepoint, data = cooking_data, paired = TRUE, alternative = "less")
t_Directions
t_Cook <- t.test(Cook ~ Timepoint, data = cooking_data, paired = TRUE, alternative = "less")
t_Cook
```
Well, it looks like mentions of cooking-related topics during Covid aren't significantly greater than mentions of cooking-related topics pre-Covid. While the media has reported the trend in cooking during Covid, people don't mention it on Twitter, Blogs, or Forums a statistically greater amount than before.  